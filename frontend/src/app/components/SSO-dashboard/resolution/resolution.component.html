<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

<main>
  <div class="header">
    <h4> Resolutions List </h4>
    <button class="btn add-new-user" (click)="toogleDisplayResolutionsForm()">Add New Resolution</button>
  </div>

<div class="complaint-wrapper">
  <div class="form-div" *ngIf='viewResolutionForm'>
    <div class="col s7 custom">
      <form #manageResolutionsForm="ngForm" (ngSubmit)="onSubmitResolution(manageResolutionsForm)" autocomplete="off">
          <p class="title">Resolutions Form</p>
          <input type="hidden" name="_id" #_id="ngModel" [(ngModel)]="resolutionService.selectedResolution._id">
          <div class="row">
            <div class="col s12">
              <label class="display-label">Complaint ID</label>
              <div class="row">
                <div class="input-field col s12">
                  <input id="complaint_id" type="text" name="complaint_id" #complaint_id="ngModel" [(ngModel)]="resolutionService.selectedResolution.complaint_id" required>
                </div>
              </div>

              <label class="display-label">Respondent ID</label>
              <div class="row">
                <div class="input-field col s12">
                  <input id="user_id" type="text" name="user_id" #user_id="ngModel" [(ngModel)]="resolutionService.selectedResolution.user_id" required>
                </div>
              </div>

              <label class="display-label">Resolution Header</label>
              <div class="row">
                <div class="input-field col s12">
                  <input id="resolution_header" type="text" name="resolution_header" #resolution_header="ngModel" [(ngModel)]="resolutionService.selectedResolution.resolution_header" required>
                </div>
              </div>

              <label class="display-label">Resolution</label>
              <div class="row">
                <div class="input-field col s12">
                  <input id="resolution_body" type="text" name="resolution_body" #resolution_body="ngModel" [(ngModel)]="resolutionService.selectedResolution.resolution_body" required>
                </div>
              </div>

              <div class="buttons">
                <div class="single-button cancel">
                  <button class="btn" type="button" (click)="resetResolutionForm()">Cancel</button>
                </div>

                <div class="single-button submit">
                  <button class="btn" type="submit" [disabled]="!manageResolutionsForm.valid">Submit</button>
                </div>
              </div>
            </div>
          </div>
        </form>
    </div>
  </div>

  <div class="table-div">
    <h3 class="empty-list-text" *ngIf="resolutionService.allResolutions.length === 0">
      There are no complaints from the students currently.
    </h3>

    <table class="responsive-table highlight" *ngIf="resolutionService.allResolutions.length !== 0">
      <thead>
        <tr>
          <th>Resolution ID</th>
          <th>Complaint ID</th>
          <th>Respondent ID</th>
          <th>Resolution Hearder</th>
          <th>Resolution Body</th>
          <th>Posted On</th>
          <th>Last Updated</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let resolution of resolutionService.allResolutions">
          <td>{{ resolution._id }}</td>
          <td>{{ resolution.complaint_id }}</td>
          <td>{{ resolution.user_id }}</td>
          <td>{{ resolution.resolution_header }}</td>
          <td>{{ resolution.resolution_body }}</td>
          <td>{{ resolution.createdAt | date:'medium' }}</td>
          <td>{{ resolution.updatedAt | date:'medium' }}</td>
          <td>
            <!-- edit button -->
            <a class="action-btn edit" title="Edit Complaint">
              <i class="material-icons" (click)="onEditResolution(resolution)">edit</i>
            </a>
            <!-- delete button -->
            <a class="action-btn delete" title="Delete Complaint">
              <i class="material-icons" (click)="onDeleteResolution(resolution._id)">delete</i>
            </a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
